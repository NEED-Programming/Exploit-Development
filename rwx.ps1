$folderPath = "C:\Windows\System32\"  # Replace with the path to the folder containing your DLLs
#$folderPath = "C:\Windows\SysWOW64\" Uncomment this to check for 64 instead of 32

# Get all DLL files in the folder
$dllFiles = Get-ChildItem -Path $folderPath -Filter "*.dll" -File -Recurse

foreach ($dllFile in $dllFiles) {
    Write-Host "Checking permissions for $($dllFile.FullName)"
    
    # Get the ACL (Access Control List) for the DLL file
    $acl = Get-Acl -Path $dllFile.FullName
    
    # Check for write and execute permissions
    $hasWrite = $acl.Access | Where-Object { $_.FileSystemRights -band [System.Security.AccessControl.FileSystemRights]::Write } | Select-Object -First 1
    $hasExecute = $acl.Access | Where-Object { $_.FileSystemRights -band [System.Security.AccessControl.FileSystemRights]::ExecuteFile } | Select-Object -First 1
    
    if ($hasWrite) {
        Write-Host "Write permission found"
    }
    else {
        Write-Host "No write permission"
    }
    
    if ($hasExecute) {
        Write-Host "Execute permission found"
    }
    else {
        Write-Host "No execute permission"
    }
    
    Write-Host "-------------------------"
}